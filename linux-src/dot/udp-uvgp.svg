<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="782pt" height="629pt"
 viewBox="0.00 0.00 781.50 629.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 625)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-625 777.5,-625 777.5,4 -4,4"/>
<text text-anchor="middle" x="53" y="-7" font-family="Times,serif" font-size="10.00">UDP Socket创建过程</text>
<!-- ut -->
<g id="node1" class="node">
<title>ut</title>
<path fill="lightgrey" stroke="transparent" d="M240,-247C240,-247 169,-247 169,-247 163,-247 157,-241 157,-235 157,-235 157,-41 157,-41 157,-35 163,-29 169,-29 169,-29 240,-29 240,-29 246,-29 252,-35 252,-41 252,-41 252,-235 252,-235 252,-241 246,-247 240,-247"/>
<polygon fill="white" stroke="transparent" points="165,-33 165,-243 244,-243 244,-33 165,-33"/>
<polygon fill="black" stroke="transparent" points="167.5,-217 167.5,-241 242.5,-241 242.5,-217 167.5,-217"/>
<polygon fill="none" stroke="black" points="167.5,-217 167.5,-241 242.5,-241 242.5,-217 167.5,-217"/>
<text text-anchor="start" x="187.5" y="-226.8" font-family="Times,serif" font-size="9.00" fill="white">udp_table</text>
<polygon fill="grey" stroke="transparent" points="167.5,-191 167.5,-215 188.5,-215 188.5,-191 167.5,-191"/>
<polygon fill="none" stroke="black" points="167.5,-191 167.5,-215 188.5,-215 188.5,-191 167.5,-191"/>
<text text-anchor="start" x="175.5" y="-200.8" font-family="Times,serif" font-size="9.00">0</text>
<polygon fill="gold" stroke="transparent" points="190.5,-191 190.5,-215 242.5,-215 242.5,-191 190.5,-191"/>
<polygon fill="none" stroke="black" points="190.5,-191 190.5,-215 242.5,-215 242.5,-191 190.5,-191"/>
<text text-anchor="start" x="197.5" y="-200.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-165 167.5,-189 188.5,-189 188.5,-165 167.5,-165"/>
<polygon fill="none" stroke="black" points="167.5,-165 167.5,-189 188.5,-189 188.5,-165 167.5,-165"/>
<text text-anchor="start" x="175.5" y="-174.8" font-family="Times,serif" font-size="9.00">1</text>
<polygon fill="grey" stroke="transparent" points="190.5,-165 190.5,-189 242.5,-189 242.5,-165 190.5,-165"/>
<polygon fill="none" stroke="black" points="190.5,-165 190.5,-189 242.5,-189 242.5,-165 190.5,-165"/>
<text text-anchor="start" x="197.5" y="-174.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-139 167.5,-163 188.5,-163 188.5,-139 167.5,-139"/>
<polygon fill="none" stroke="black" points="167.5,-139 167.5,-163 188.5,-163 188.5,-139 167.5,-139"/>
<text text-anchor="start" x="175.5" y="-148.8" font-family="Times,serif" font-size="9.00">2</text>
<polygon fill="grey" stroke="transparent" points="190.5,-139 190.5,-163 242.5,-163 242.5,-139 190.5,-139"/>
<polygon fill="none" stroke="black" points="190.5,-139 190.5,-163 242.5,-163 242.5,-139 190.5,-139"/>
<text text-anchor="start" x="197.5" y="-148.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-113 167.5,-137 188.5,-137 188.5,-113 167.5,-113"/>
<polygon fill="none" stroke="black" points="167.5,-113 167.5,-137 188.5,-137 188.5,-113 167.5,-113"/>
<text text-anchor="start" x="175.5" y="-122.8" font-family="Times,serif" font-size="9.00">3</text>
<polygon fill="grey" stroke="transparent" points="190.5,-113 190.5,-137 242.5,-137 242.5,-113 190.5,-113"/>
<polygon fill="none" stroke="black" points="190.5,-113 190.5,-137 242.5,-137 242.5,-113 190.5,-113"/>
<text text-anchor="start" x="197.5" y="-122.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-87 167.5,-111 188.5,-111 188.5,-87 167.5,-87"/>
<polygon fill="none" stroke="black" points="167.5,-87 167.5,-111 188.5,-111 188.5,-87 167.5,-87"/>
<text text-anchor="start" x="175.5" y="-96.8" font-family="Times,serif" font-size="9.00">4</text>
<polygon fill="grey" stroke="transparent" points="190.5,-87 190.5,-111 242.5,-111 242.5,-87 190.5,-87"/>
<polygon fill="none" stroke="black" points="190.5,-87 190.5,-111 242.5,-111 242.5,-87 190.5,-87"/>
<text text-anchor="start" x="197.5" y="-96.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-61 167.5,-85 188.5,-85 188.5,-61 167.5,-61"/>
<polygon fill="none" stroke="black" points="167.5,-61 167.5,-85 188.5,-85 188.5,-61 167.5,-61"/>
<text text-anchor="start" x="174.5" y="-70.8" font-family="Times,serif" font-size="9.00">...</text>
<polygon fill="grey" stroke="transparent" points="190.5,-61 190.5,-85 242.5,-85 242.5,-61 190.5,-61"/>
<polygon fill="none" stroke="black" points="190.5,-61 190.5,-85 242.5,-85 242.5,-61 190.5,-61"/>
<text text-anchor="start" x="197.5" y="-70.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-35 167.5,-59 188.5,-59 188.5,-35 167.5,-35"/>
<polygon fill="none" stroke="black" points="167.5,-35 167.5,-59 188.5,-59 188.5,-35 167.5,-35"/>
<text text-anchor="start" x="175.5" y="-44.8" font-family="Times,serif" font-size="9.00">n</text>
<polygon fill="grey" stroke="transparent" points="190.5,-35 190.5,-59 242.5,-59 242.5,-35 190.5,-35"/>
<polygon fill="none" stroke="black" points="190.5,-35 190.5,-59 242.5,-59 242.5,-35 190.5,-35"/>
<text text-anchor="start" x="197.5" y="-44.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<text text-anchor="middle" x="90" y="-21.8" font-family="Times,serif" font-size="9.00">udp_table 使用端口号作为 hash key</text>
</g>
<!-- uh01 -->
<g id="node4" class="node">
<title>uh01</title>
<path fill="lightgrey" stroke="transparent" d="M421.17,-214C421.17,-214 349.83,-214 349.83,-214 346.17,-214 342.5,-210.33 342.5,-206.67 342.5,-206.67 342.5,-199.33 342.5,-199.33 342.5,-195.67 346.17,-192 349.83,-192 349.83,-192 421.17,-192 421.17,-192 424.83,-192 428.5,-195.67 428.5,-199.33 428.5,-199.33 428.5,-206.67 428.5,-206.67 428.5,-210.33 424.83,-214 421.17,-214"/>
<text text-anchor="middle" x="385.5" y="-200.8" font-family="Times,serif" font-size="9.00">udp_hslot</text>
<text text-anchor="middle" x="350" y="-184.8" font-family="Times,serif" font-size="9.00">链表上超过10个节点时，使用udp_table2</text>
</g>
<!-- ut&#45;&gt;uh01 -->
<g id="edge1" class="edge">
<title>ut:r1&#45;&gt;uh01</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M243.5,-203C274.73,-203 309.84,-203 337.22,-203"/>
<polygon fill="black" stroke="black" points="342.24,-203 337.24,-205.25 339.74,-203 337.24,-203 337.24,-203 337.24,-203 339.74,-203 337.24,-200.75 342.24,-203 342.24,-203"/>
</g>
<!-- ut2 -->
<g id="node2" class="node">
<title>ut2</title>
<path fill="lightgrey" stroke="transparent" d="M240,-479C240,-479 169,-479 169,-479 163,-479 157,-473 157,-467 157,-467 157,-273 157,-273 157,-267 163,-261 169,-261 169,-261 240,-261 240,-261 246,-261 252,-267 252,-273 252,-273 252,-467 252,-467 252,-473 246,-479 240,-479"/>
<polygon fill="white" stroke="transparent" points="165,-265 165,-475 244,-475 244,-265 165,-265"/>
<polygon fill="black" stroke="transparent" points="167.5,-449 167.5,-473 242.5,-473 242.5,-449 167.5,-449"/>
<polygon fill="none" stroke="black" points="167.5,-449 167.5,-473 242.5,-473 242.5,-449 167.5,-449"/>
<text text-anchor="start" x="185" y="-458.8" font-family="Times,serif" font-size="9.00" fill="white">udp_table2</text>
<polygon fill="grey" stroke="transparent" points="167.5,-423 167.5,-447 188.5,-447 188.5,-423 167.5,-423"/>
<polygon fill="none" stroke="black" points="167.5,-423 167.5,-447 188.5,-447 188.5,-423 167.5,-423"/>
<text text-anchor="start" x="175.5" y="-432.8" font-family="Times,serif" font-size="9.00">0</text>
<polygon fill="gold" stroke="transparent" points="190.5,-423 190.5,-447 242.5,-447 242.5,-423 190.5,-423"/>
<polygon fill="none" stroke="black" points="190.5,-423 190.5,-447 242.5,-447 242.5,-423 190.5,-423"/>
<text text-anchor="start" x="197.5" y="-432.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-397 167.5,-421 188.5,-421 188.5,-397 167.5,-397"/>
<polygon fill="none" stroke="black" points="167.5,-397 167.5,-421 188.5,-421 188.5,-397 167.5,-397"/>
<text text-anchor="start" x="175.5" y="-406.8" font-family="Times,serif" font-size="9.00">1</text>
<polygon fill="grey" stroke="transparent" points="190.5,-397 190.5,-421 242.5,-421 242.5,-397 190.5,-397"/>
<polygon fill="none" stroke="black" points="190.5,-397 190.5,-421 242.5,-421 242.5,-397 190.5,-397"/>
<text text-anchor="start" x="197.5" y="-406.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-371 167.5,-395 188.5,-395 188.5,-371 167.5,-371"/>
<polygon fill="none" stroke="black" points="167.5,-371 167.5,-395 188.5,-395 188.5,-371 167.5,-371"/>
<text text-anchor="start" x="175.5" y="-380.8" font-family="Times,serif" font-size="9.00">2</text>
<polygon fill="grey" stroke="transparent" points="190.5,-371 190.5,-395 242.5,-395 242.5,-371 190.5,-371"/>
<polygon fill="none" stroke="black" points="190.5,-371 190.5,-395 242.5,-395 242.5,-371 190.5,-371"/>
<text text-anchor="start" x="197.5" y="-380.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-345 167.5,-369 188.5,-369 188.5,-345 167.5,-345"/>
<polygon fill="none" stroke="black" points="167.5,-345 167.5,-369 188.5,-369 188.5,-345 167.5,-345"/>
<text text-anchor="start" x="175.5" y="-354.8" font-family="Times,serif" font-size="9.00">3</text>
<polygon fill="grey" stroke="transparent" points="190.5,-345 190.5,-369 242.5,-369 242.5,-345 190.5,-345"/>
<polygon fill="none" stroke="black" points="190.5,-345 190.5,-369 242.5,-369 242.5,-345 190.5,-345"/>
<text text-anchor="start" x="197.5" y="-354.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-319 167.5,-343 188.5,-343 188.5,-319 167.5,-319"/>
<polygon fill="none" stroke="black" points="167.5,-319 167.5,-343 188.5,-343 188.5,-319 167.5,-319"/>
<text text-anchor="start" x="175.5" y="-328.8" font-family="Times,serif" font-size="9.00">4</text>
<polygon fill="grey" stroke="transparent" points="190.5,-319 190.5,-343 242.5,-343 242.5,-319 190.5,-319"/>
<polygon fill="none" stroke="black" points="190.5,-319 190.5,-343 242.5,-343 242.5,-319 190.5,-319"/>
<text text-anchor="start" x="197.5" y="-328.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-293 167.5,-317 188.5,-317 188.5,-293 167.5,-293"/>
<polygon fill="none" stroke="black" points="167.5,-293 167.5,-317 188.5,-317 188.5,-293 167.5,-293"/>
<text text-anchor="start" x="174.5" y="-302.8" font-family="Times,serif" font-size="9.00">...</text>
<polygon fill="grey" stroke="transparent" points="190.5,-293 190.5,-317 242.5,-317 242.5,-293 190.5,-293"/>
<polygon fill="none" stroke="black" points="190.5,-293 190.5,-317 242.5,-317 242.5,-293 190.5,-293"/>
<text text-anchor="start" x="197.5" y="-302.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<polygon fill="grey" stroke="transparent" points="167.5,-267 167.5,-291 188.5,-291 188.5,-267 167.5,-267"/>
<polygon fill="none" stroke="black" points="167.5,-267 167.5,-291 188.5,-291 188.5,-267 167.5,-267"/>
<text text-anchor="start" x="175.5" y="-276.8" font-family="Times,serif" font-size="9.00">n</text>
<polygon fill="grey" stroke="transparent" points="190.5,-267 190.5,-291 242.5,-291 242.5,-267 190.5,-267"/>
<polygon fill="none" stroke="black" points="190.5,-267 190.5,-291 242.5,-291 242.5,-267 190.5,-267"/>
<text text-anchor="start" x="197.5" y="-276.8" font-family="Times,serif" font-size="9.00">udp_hslot </text>
<text text-anchor="middle" x="78.5" y="-253.8" font-family="Times,serif" font-size="9.00">udp_table2 使用端口和地址作为 hash key</text>
</g>
<!-- uh -->
<g id="node3" class="node">
<title>uh</title>
<path fill="gold" stroke="transparent" d="M301.5,-621C301.5,-621 107.5,-621 107.5,-621 101.5,-621 95.5,-615 95.5,-609 95.5,-609 95.5,-505 95.5,-505 95.5,-499 101.5,-493 107.5,-493 107.5,-493 301.5,-493 301.5,-493 307.5,-493 313.5,-499 313.5,-505 313.5,-505 313.5,-609 313.5,-609 313.5,-615 307.5,-621 301.5,-621"/>
<text text-anchor="start" x="103.5" y="-609.8" font-family="Times,serif" font-size="9.00">/**</text>
<text text-anchor="start" x="103.5" y="-599.8" font-family="Times,serif" font-size="9.00"> *	struct udp_hslot &#45; UDP hash slot</text>
<text text-anchor="start" x="103.5" y="-589.8" font-family="Times,serif" font-size="9.00"> *</text>
<text text-anchor="start" x="103.5" y="-579.8" font-family="Times,serif" font-size="9.00"> *	@head:	head of list of sockets</text>
<text text-anchor="start" x="103.5" y="-569.8" font-family="Times,serif" font-size="9.00"> *	@count:	number of sockets in &#39;head&#39; list</text>
<text text-anchor="start" x="103.5" y="-559.8" font-family="Times,serif" font-size="9.00"> *	@lock:	spinlock protecting changes to head/count</text>
<text text-anchor="start" x="103.5" y="-549.8" font-family="Times,serif" font-size="9.00"> */</text>
<text text-anchor="start" x="103.5" y="-539.8" font-family="Times,serif" font-size="9.00">struct udp_hslot {</text>
<text text-anchor="start" x="103.5" y="-529.8" font-family="Times,serif" font-size="9.00">	struct hlist_head	head;</text>
<text text-anchor="start" x="103.5" y="-519.8" font-family="Times,serif" font-size="9.00">	int				count;</text>
<text text-anchor="start" x="103.5" y="-509.8" font-family="Times,serif" font-size="9.00">	spinlock_t		lock;</text>
<text text-anchor="start" x="103.5" y="-499.8" font-family="Times,serif" font-size="9.00">} __attribute__((aligned(2 * sizeof(long))));</text>
</g>
<!-- uh02 -->
<g id="node5" class="node">
<title>uh02</title>
<path fill="lightgrey" stroke="transparent" d="M536.17,-214C536.17,-214 464.83,-214 464.83,-214 461.17,-214 457.5,-210.33 457.5,-206.67 457.5,-206.67 457.5,-199.33 457.5,-199.33 457.5,-195.67 461.17,-192 464.83,-192 464.83,-192 536.17,-192 536.17,-192 539.83,-192 543.5,-195.67 543.5,-199.33 543.5,-199.33 543.5,-206.67 543.5,-206.67 543.5,-210.33 539.83,-214 536.17,-214"/>
<text text-anchor="middle" x="500.5" y="-200.8" font-family="Times,serif" font-size="9.00">udp_hslot</text>
</g>
<!-- uh01&#45;&gt;uh02 -->
<g id="edge2" class="edge">
<title>uh01&#45;&gt;uh02</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M428.58,-203C436.22,-203 444.25,-203 452.04,-203"/>
<polygon fill="black" stroke="black" points="457.39,-203 452.39,-205.25 454.89,-203 452.39,-203 452.39,-203 452.39,-203 454.89,-203 452.39,-200.75 457.39,-203 457.39,-203"/>
</g>
<!-- uh03 -->
<g id="node6" class="node">
<title>uh03</title>
<path fill="lightgrey" stroke="transparent" d="M651.17,-214C651.17,-214 579.83,-214 579.83,-214 576.17,-214 572.5,-210.33 572.5,-206.67 572.5,-206.67 572.5,-199.33 572.5,-199.33 572.5,-195.67 576.17,-192 579.83,-192 579.83,-192 651.17,-192 651.17,-192 654.83,-192 658.5,-195.67 658.5,-199.33 658.5,-199.33 658.5,-206.67 658.5,-206.67 658.5,-210.33 654.83,-214 651.17,-214"/>
<text text-anchor="middle" x="615.5" y="-200.8" font-family="Times,serif" font-size="9.00">udp_hslot</text>
</g>
<!-- uh02&#45;&gt;uh03 -->
<g id="edge3" class="edge">
<title>uh02&#45;&gt;uh03</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M543.58,-203C551.22,-203 559.25,-203 567.04,-203"/>
<polygon fill="black" stroke="black" points="572.39,-203 567.39,-205.25 569.89,-203 567.39,-203 567.39,-203 567.39,-203 569.89,-203 567.39,-200.75 572.39,-203 572.39,-203"/>
</g>
<!-- uh04 -->
<g id="node7" class="node">
<title>uh04</title>
<path fill="lightgrey" stroke="transparent" d="M766.17,-214C766.17,-214 694.83,-214 694.83,-214 691.17,-214 687.5,-210.33 687.5,-206.67 687.5,-206.67 687.5,-199.33 687.5,-199.33 687.5,-195.67 691.17,-192 694.83,-192 694.83,-192 766.17,-192 766.17,-192 769.83,-192 773.5,-195.67 773.5,-199.33 773.5,-199.33 773.5,-206.67 773.5,-206.67 773.5,-210.33 769.83,-214 766.17,-214"/>
<text text-anchor="middle" x="730.5" y="-200.8" font-family="Times,serif" font-size="9.00">udp_hslot</text>
</g>
<!-- uh03&#45;&gt;uh04 -->
<g id="edge4" class="edge">
<title>uh03&#45;&gt;uh04</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M658.58,-203C666.22,-203 674.25,-203 682.04,-203"/>
<polygon fill="black" stroke="black" points="687.39,-203 682.39,-205.25 684.89,-203 682.39,-203 682.39,-203 682.39,-203 684.89,-203 682.39,-200.75 687.39,-203 687.39,-203"/>
</g>
</g>
</svg>

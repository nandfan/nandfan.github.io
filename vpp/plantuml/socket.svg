<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="607px" preserveAspectRatio="none" style="width:394px;height:607px;" version="1.1" viewBox="0 0 394 607" width="394px" zoomAndPan="magnify"><defs><filter height="300%" id="f1aaciur7znanu" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="18" lengthAdjust="spacingAndGlyphs" textLength="55" x="168.5" y="30.8799">socket</text><path d="M119.5,36.0638 L119.5,64.8879 L206.5,64.8879 L206.5,46.0638 L196.5,36.0638 L119.5,36.0638 " fill="#FBFB77" filter="url(#f1aaciur7znanu)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M196.5,36.0638 L196.5,46.0638 L206.5,46.0638 L196.5,36.0638 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="125.5" y="56.1439">socket函数</text><ellipse cx="236.5" cy="50.4758" fill="#000000" filter="url(#f1aaciur7znanu)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="54.7522" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="182" x="145.5" y="84.8879"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="42" x="155.5" y="108.808">ldp_init</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="162" x="155.5" y="126.1841">判断是否进行了ldp_init初始化</text><polygon fill="#FEFECE" filter="url(#f1aaciur7znanu)" points="154,159.6401,319,159.6401,331,175.568,319,191.4959,154,191.4959,142,175.568,154,159.6401" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="165" x="154" y="172.4">domain是AF_INET或者AF_INET6</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="137" x="154" y="188.3279">并且套接字类型为tcp或udp</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="17" x="125" y="172.4">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="331" y="172.4">no</text><rect fill="#FFFFFF" filter="url(#f1aaciur7znanu)" height="322.9564" style="stroke: #000000; stroke-width: 2.0;" width="244" x="10" y="201.4959"/><path d="M87,202.4959 L87,214.7678 L77,224.7678 L10,224.7678 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="67" x="13" y="218.7358">vls_create</text><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="98" y="241.7678"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="108" y="265.6879">安全检查</text><rect fill="#FFFFFF" filter="url(#f1aaciur7znanu)" height="221.7764" style="stroke: #000000; stroke-width: 2.0;" width="224" x="20" y="290.6759"/><path d="M190,291.6759 L190,303.9478 L180,313.9478 L20,313.9478 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="160" x="23" y="307.9158">vppcom_session_create</text><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="54.7522" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="144" x="60" y="330.9478"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="70" y="354.8679">vcl_session_alloc</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="124" x="70" y="372.244">分配vcl_session_t结构</text><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="204" x="30" y="405.7"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="184" x="40" y="429.6201">初始化新分配的vcl_session_t结构</text><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="68" x="98" y="463.0762"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="48" x="108" y="486.9962">vls_alloc</text><rect fill="#FEFECE" filter="url(#f1aaciur7znanu)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="84" x="299" y="201.4959"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="64" x="309" y="225.416">libc_socket</text><polygon fill="#FEFECE" filter="url(#f1aaciur7znanu)" points="236.5,530.4523,248.5,542.4523,236.5,554.4523,224.5,542.4523,236.5,530.4523" style="stroke: #A80036; stroke-width: 1.5;"/><ellipse cx="236.5" cy="585.4523" fill="#FFFFFF" filter="url(#f1aaciur7znanu)" rx="11" ry="11" style="stroke: #000000; stroke-width: 1.0;"/><ellipse cx="236.5" cy="585.4523" fill="#000000" rx="6" ry="6" style="stroke: #7F7F7F; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="236.5" x2="236.5" y1="60.4758" y2="84.8879"/><polygon fill="#A80036" points="232.5,74.8879,236.5,84.8879,240.5,74.8879,236.5,78.8879" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="132" y1="385.7" y2="405.7"/><polygon fill="#A80036" points="128,395.7,132,405.7,136,395.7,132,399.7" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="132" y1="443.0762" y2="463.0762"/><polygon fill="#A80036" points="128,453.0762,132,463.0762,136,453.0762,132,457.0762" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="132" y1="279.1439" y2="330.9478"/><polygon fill="#A80036" points="128,320.9478,132,330.9478,136,320.9478,132,324.9478" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="142" x2="132" y1="175.568" y2="175.568"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="132" y1="175.568" y2="241.7678"/><polygon fill="#A80036" points="128,231.7678,132,241.7678,136,231.7678,132,235.7678" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="331" x2="341" y1="175.568" y2="175.568"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="341" x2="341" y1="175.568" y2="201.4959"/><polygon fill="#A80036" points="337,191.4959,341,201.4959,345,191.4959,341,195.4959" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="132" y1="500.4523" y2="542.4523"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="132" x2="224.5" y1="542.4523" y2="542.4523"/><polygon fill="#A80036" points="214.5,538.4523,224.5,542.4523,214.5,546.4523,218.5,542.4523" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="341" x2="341" y1="238.872" y2="542.4523"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="341" x2="248.5" y1="542.4523" y2="542.4523"/><polygon fill="#A80036" points="258.5,538.4523,248.5,542.4523,258.5,546.4523,254.5,542.4523" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="236.5" x2="236.5" y1="139.6401" y2="159.6401"/><polygon fill="#A80036" points="232.5,149.6401,236.5,159.6401,240.5,149.6401,236.5,153.6401" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="236.5" x2="236.5" y1="554.4523" y2="574.4523"/><polygon fill="#A80036" points="232.5,564.4523,236.5,574.4523,240.5,564.4523,236.5,568.4523" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[af6ce76f9f619f161939032e163c26f2]
@startuml
title socket
start
floating note left: socket函数
:ldp_init
判断是否进行了ldp_init初始化;
if (domain是AF_INET或者AF_INET6
并且套接字类型为tcp或udp) then (yes)
        partition vls_create {
                :安全检查;
                partition vppcom_session_create {
                        :vcl_session_alloc
                        分配vcl_session_t结构;
                        :初始化新分配的vcl_session_t结构;
                :vls_alloc;
                }
        }
else (no)
        :libc_socket;
endif
stop
@enduml

PlantUML version 1.2020.02(Sun Mar 01 18:22:07 CST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.11+9-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
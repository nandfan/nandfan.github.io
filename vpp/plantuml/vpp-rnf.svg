<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="647px" preserveAspectRatio="none" style="width:701px;height:647px;" version="1.1" viewBox="0 0 701 647" width="701px" zoomAndPan="magnify"><defs><filter height="300%" id="f17zl7p57izu17" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><ellipse cx="342.5" cy="20" fill="#000000" filter="url(#f17zl7p57izu17)" rx="10" ry="10" style="stroke: none; stroke-width: 1.0;"/><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="229" x="228" y="50"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="209" x="238" y="73.9201">判断函数是否使用VLIB_NODE_FN注册</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="210" x="237.5" y="107.3761"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="190" x="247.5" y="131.2962">分配vlib_node_t结构用来注册node</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="287" x="199" y="164.7522"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="267" x="209" y="188.6723">初始化并添加至vlib_node_main_t的nodes成员中</text><rect fill="#FFFFFF" filter="url(#f17zl7p57izu17)" height="383.1525" style="stroke: #000000; stroke-width: 2.0;" width="680" x="10" y="213.6603"/><path d="M185,214.6603 L185,226.9323 L175,236.9323 L10,236.9323 " fill="none" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="165" x="13" y="230.9003">init vlib_node_runtime_t</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="157" x="264" y="253.9323"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="137" x="274" y="277.8524">vlib_node_runtime_t *rt</text><polygon fill="#FEFECE" filter="url(#f17zl7p57izu17)" points="234,311.3084,451,311.3084,463,323.3084,451,335.3084,234,335.3084,222,323.3084,234,311.3084" style="stroke: #A80036; stroke-width: 1.5;"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="217" x="234" y="328.1043">node的type为VLIB_NODE_TYPE_PROCESS</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="17" x="205" y="320.1404">yes</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="14" x="463" y="320.1404">no</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="150" x="100.5" y="345.3084"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="130" x="110.5" y="369.2285">创建vlib_process_t结构</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="286" x="32.5" y="402.6845"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="266" x="42.5" y="426.6046">添加至vlib_node_main_t结构的processes成员中</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="291" x="30" y="460.0606"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="271" x="40" y="483.9807">rt 取值为vlib_process_t结构的node_runtime成员</text><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="337" x="341" y="345.3084"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="317" x="351" y="369.2285">从vlib_node_main_t结构中的nodes_by_type成员中分配rt</text><polygon fill="#FEFECE" filter="url(#f17zl7p57izu17)" points="342.5,503.4367,354.5,515.4367,342.5,527.4367,330.5,515.4367,342.5,503.4367" style="stroke: #A80036; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#f17zl7p57izu17)" height="37.3761" rx="12.5" ry="12.5" style="stroke: #A80036; stroke-width: 1.5;" width="69" x="308" y="547.4367"/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="46" x="318" y="571.3568">初始化rt</text><ellipse cx="342.5" cy="626.8129" fill="#FFFFFF" filter="url(#f17zl7p57izu17)" rx="10" ry="10" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 2.5;" x1="336.3128" x2="348.6872" y1="620.6257" y2="633.0001"/><line style="stroke: #000000; stroke-width: 2.5;" x1="348.6872" x2="336.3128" y1="620.6257" y2="633.0001"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="30" y2="50"/><polygon fill="#A80036" points="338.5,40,342.5,50,346.5,40,342.5,44" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="87.3761" y2="107.3761"/><polygon fill="#A80036" points="338.5,97.3761,342.5,107.3761,346.5,97.3761,342.5,101.3761" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="144.7522" y2="164.7522"/><polygon fill="#A80036" points="338.5,154.7522,342.5,164.7522,346.5,154.7522,342.5,158.7522" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="175.5" x2="175.5" y1="382.6845" y2="402.6845"/><polygon fill="#A80036" points="171.5,392.6845,175.5,402.6845,179.5,392.6845,175.5,396.6845" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="175.5" x2="175.5" y1="440.0606" y2="460.0606"/><polygon fill="#A80036" points="171.5,450.0606,175.5,460.0606,179.5,450.0606,175.5,454.0606" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="222" x2="175.5" y1="323.3084" y2="323.3084"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="175.5" x2="175.5" y1="323.3084" y2="345.3084"/><polygon fill="#A80036" points="171.5,335.3084,175.5,345.3084,179.5,335.3084,175.5,339.3084" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="463" x2="509.5" y1="323.3084" y2="323.3084"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="509.5" x2="509.5" y1="323.3084" y2="345.3084"/><polygon fill="#A80036" points="505.5,335.3084,509.5,345.3084,513.5,335.3084,509.5,339.3084" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="175.5" x2="175.5" y1="497.4367" y2="515.4367"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="175.5" x2="330.5" y1="515.4367" y2="515.4367"/><polygon fill="#A80036" points="320.5,511.4367,330.5,515.4367,320.5,519.4367,324.5,515.4367" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="509.5" x2="509.5" y1="382.6845" y2="515.4367"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="509.5" x2="354.5" y1="515.4367" y2="515.4367"/><polygon fill="#A80036" points="364.5,511.4367,354.5,515.4367,364.5,519.4367,360.5,515.4367" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="291.3084" y2="311.3084"/><polygon fill="#A80036" points="338.5,301.3084,342.5,311.3084,346.5,301.3084,342.5,305.3084" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="527.4367" y2="547.4367"/><polygon fill="#A80036" points="338.5,537.4367,342.5,547.4367,346.5,537.4367,342.5,541.4367" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="202.1284" y2="253.9323"/><polygon fill="#A80036" points="338.5,243.9323,342.5,253.9323,346.5,243.9323,342.5,247.9323" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="342.5" x2="342.5" y1="584.8129" y2="616.8129"/><polygon fill="#A80036" points="338.5,606.8129,342.5,616.8129,346.5,606.8129,342.5,610.8129" style="stroke: #A80036; stroke-width: 1.0;"/><!--MD5=[9601b9e3421224f6f86972a6db75f3d1]
@startuml
start
:判断函数是否使用VLIB_NODE_FN注册;

:分配vlib_node_t结构用来注册node;
:初始化并添加至vlib_node_main_t的nodes成员中;
partition "init vlib_node_runtime_t" {
        :vlib_node_runtime_t *rt;
        if (node的type为VLIB_NODE_TYPE_PROCESS) then (yes)
           :创建vlib_process_t结构;
           :添加至vlib_node_main_t结构的processes成员中;
           :rt 取值为vlib_process_t结构的node_runtime成员;
        else (no)
             :从vlib_node_main_t结构中的nodes_by_type成员中分配rt;
        endif
        :初始化rt ;
}
end
@enduml

PlantUML version 1.2020.02(Sun Mar 01 18:22:07 CST 2020)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.7+7-Debian-1deb12u1
Operating System: Linux
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>
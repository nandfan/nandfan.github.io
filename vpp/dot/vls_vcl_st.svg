<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: vls_vcl Pages: 1 -->
<svg width="1120pt" height="1679pt"
 viewBox="0.00 0.00 1120.00 1679.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1675)">
<title>vls_vcl</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1675 1116,-1675 1116,4 -4,4"/>
<text text-anchor="middle" x="556" y="-7.8" font-family="Times,serif" font-size="14.00">vls 和 vcl相关结构</text>
<!-- vcm -->
<g id="node1" class="node">
<title>vcm</title>
<polygon fill="#00b2ee" stroke="transparent" points="546,-1651 546,-1667 752,-1667 752,-1651 546,-1651"/>
<text text-anchor="start" x="607.5" y="-1656.2" font-family="Microsoft YaHei" font-size="11.00">vppcom_main_t</text>
<polygon fill="none" stroke="black" points="546,-1633 546,-1651 752,-1651 752,-1633 546,-1633"/>
<text text-anchor="start" x="624" y="-1639.2" font-family="Microsoft YaHei" font-size="11.00">u8 is_init;</text>
<polygon fill="none" stroke="black" points="546,-1615 546,-1633 752,-1633 752,-1615 546,-1615"/>
<text text-anchor="start" x="619" y="-1621.2" font-family="Microsoft YaHei" font-size="11.00">u32 debug;</text>
<polygon fill="none" stroke="black" points="546,-1597 546,-1615 752,-1615 752,-1597 546,-1597"/>
<text text-anchor="start" x="596" y="-1603.2" font-family="Microsoft YaHei" font-size="11.00">pthread_t main_cpu;</text>
<polygon fill="none" stroke="black" points="546,-1567 546,-1597 752,-1597 752,-1567 546,-1567"/>
<text text-anchor="start" x="609" y="-1585.2" font-family="Microsoft YaHei" font-size="11.00">pid_t main_pid;</text>
<text text-anchor="start" x="632.5" y="-1573.2" font-family="Microsoft YaHei" font-size="11.00">进程id</text>
<polygon fill="none" stroke="black" points="546,-1537 546,-1567 752,-1567 752,-1537 546,-1537"/>
<text text-anchor="start" x="609.5" y="-1555.2" font-family="Microsoft YaHei" font-size="11.00">u32 app_index;</text>
<text text-anchor="start" x="601" y="-1543.2" font-family="Microsoft YaHei" font-size="11.00">app在vpp中的索引</text>
<polygon fill="none" stroke="black" points="546,-1519 546,-1537 752,-1537 752,-1519 546,-1519"/>
<text text-anchor="start" x="609.5" y="-1525.2" font-family="Microsoft YaHei" font-size="11.00">u8 *app_name;</text>
<polygon fill="none" stroke="black" points="546,-1489 546,-1519 752,-1519 752,-1489 546,-1489"/>
<text text-anchor="start" x="602" y="-1507.2" font-family="Microsoft YaHei" font-size="11.00">vppcom_cfg_t cfg;</text>
<text text-anchor="start" x="630.5" y="-1495.2" font-family="Microsoft YaHei" font-size="11.00">vcl配置</text>
<polygon fill="none" stroke="black" points="546,-1471 546,-1489 752,-1489 752,-1471 546,-1471"/>
<text text-anchor="start" x="596.5" y="-1477.2" font-family="Microsoft YaHei" font-size="11.00">volatile u32 forking;</text>
<polygon fill="none" stroke="black" points="546,-1453 546,-1471 752,-1471 752,-1453 546,-1453"/>
<text text-anchor="start" x="589.5" y="-1459.2" font-family="Microsoft YaHei" font-size="11.00">vcl_worker_t *workers;</text>
<polygon fill="none" stroke="black" points="546,-1435 546,-1453 752,-1453 752,-1435 546,-1435"/>
<text text-anchor="start" x="574" y="-1441.2" font-family="Microsoft YaHei" font-size="11.00">clib_spinlock_t workers_lock;</text>
<polygon fill="none" stroke="black" points="546,-1417 546,-1435 752,-1435 752,-1417 546,-1417"/>
<text text-anchor="start" x="561.5" y="-1423.2" font-family="Microsoft YaHei" font-size="11.00">clib_rwlock_t segment_table_lock;</text>
<polygon fill="none" stroke="black" points="546,-1387 546,-1417 752,-1417 752,-1387 546,-1387"/>
<text text-anchor="start" x="588.5" y="-1405.2" font-family="Microsoft YaHei" font-size="11.00">uword *segment_table;</text>
<text text-anchor="start" x="603.5" y="-1393.2" font-family="Microsoft YaHei" font-size="11.00">映射的segment表</text>
<polygon fill="none" stroke="black" points="546,-1357 546,-1387 752,-1387 752,-1357 546,-1357"/>
<text text-anchor="start" x="588.5" y="-1375.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t *ctrl_mq;</text>
<text text-anchor="start" x="590.5" y="-1363.2" font-family="Microsoft YaHei" font-size="11.00">attach时得到的控制mq</text>
<polygon fill="none" stroke="black" points="546,-1339 546,-1357 752,-1357 752,-1339 546,-1339"/>
<text text-anchor="start" x="553.5" y="-1345.2" font-family="Microsoft YaHei" font-size="11.00">fifo_segment_main_t segment_main;</text>
<polygon fill="none" stroke="black" points="546,-1321 546,-1339 752,-1339 752,-1321 546,-1321"/>
<text text-anchor="start" x="584" y="-1327.2" font-family="Microsoft YaHei" font-size="11.00">vcl_rpc_fn_t *wrk_rpc_fn;</text>
<polygon fill="none" stroke="black" points="546,-1303 546,-1321 752,-1321 752,-1303 546,-1303"/>
<text text-anchor="start" x="549" y="-1309.2" font-family="Microsoft YaHei" font-size="11.00">uword *error_string_by_error_number;</text>
</g>
<!-- vclwp -->
<g id="node2" class="node">
<title>vclwp</title>
<polygon fill="#00b2ee" stroke="transparent" points="1019,-1368 1019,-1384 1104,-1384 1104,-1368 1019,-1368"/>
<text text-anchor="start" x="1021" y="-1373.2" font-family="Microsoft YaHei" font-size="11.00">vcl worker pool</text>
<polygon fill="none" stroke="black" points="1019,-1350 1019,-1368 1104,-1368 1104,-1350 1019,-1350"/>
<text text-anchor="start" x="1058" y="-1356.2" font-family="Microsoft YaHei" font-size="11.00">0</text>
<polygon fill="none" stroke="black" points="1019,-1332 1019,-1350 1104,-1350 1104,-1332 1019,-1332"/>
<text text-anchor="start" x="1058" y="-1338.2" font-family="Microsoft YaHei" font-size="11.00">1</text>
<polygon fill="none" stroke="black" points="1019,-1314 1019,-1332 1104,-1332 1104,-1314 1019,-1314"/>
<text text-anchor="start" x="1058" y="-1320.2" font-family="Microsoft YaHei" font-size="11.00">2</text>
<polygon fill="none" stroke="black" points="1019,-1296 1019,-1314 1104,-1314 1104,-1296 1019,-1296"/>
<text text-anchor="start" x="1056.5" y="-1302.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
<polygon fill="none" stroke="black" points="1019,-1278 1019,-1296 1104,-1296 1104,-1278 1019,-1278"/>
<text text-anchor="start" x="1026.5" y="-1284.2" font-family="Microsoft YaHei" font-size="11.00">max_workers</text>
</g>
<!-- vcm&#45;&gt;vclwp -->
<g id="edge1" class="edge">
<title>vcm:vclw&#45;&gt;vclwp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M753,-1462C845.65,-1462 942.32,-1410.9 1001.85,-1372.53"/>
<polygon fill="black" stroke="black" points="1003.9,-1375.37 1010.36,-1366.97 1000.07,-1369.51 1003.9,-1375.37"/>
<text text-anchor="middle" x="888" y="-1462.2" font-family="Microsoft YaHei" font-size="11.00">指向vcl worker pool</text>
</g>
<!-- vlsm -->
<g id="node3" class="node">
<title>vlsm</title>
<polygon fill="#00b2ee" stroke="transparent" points="16.5,-117 16.5,-133 215.5,-133 215.5,-117 16.5,-117"/>
<text text-anchor="start" x="88.5" y="-122.2" font-family="Microsoft YaHei" font-size="11.00">vls_main_t</text>
<polygon fill="none" stroke="black" points="16.5,-99 16.5,-117 215.5,-117 215.5,-99 16.5,-99"/>
<text text-anchor="start" x="56.5" y="-105.2" font-family="Microsoft YaHei" font-size="11.00">vls_worker_t *workers;</text>
<polygon fill="none" stroke="black" points="16.5,-81 16.5,-99 215.5,-99 215.5,-81 16.5,-81"/>
<text text-anchor="start" x="43.5" y="-87.2" font-family="Microsoft YaHei" font-size="11.00">clib_rwlock_t vls_table_lock;</text>
<polygon fill="none" stroke="black" points="16.5,-63 16.5,-81 215.5,-81 215.5,-63 16.5,-63"/>
<text text-anchor="start" x="19.5" y="-69.2" font-family="Microsoft YaHei" font-size="11.00">vls_shared_data_t *shared_data_pool;</text>
<polygon fill="none" stroke="black" points="16.5,-45 16.5,-63 215.5,-63 215.5,-45 16.5,-45"/>
<text text-anchor="start" x="35" y="-51.2" font-family="Microsoft YaHei" font-size="11.00">clib_rwlock_t shared_data_lock;</text>
<polygon fill="none" stroke="black" points="16.5,-27 16.5,-45 215.5,-45 215.5,-27 16.5,-27"/>
<text text-anchor="start" x="33" y="-33.2" font-family="Microsoft YaHei" font-size="11.00">clib_spinlock_t worker_rpc_lock;</text>
</g>
<!-- vlswp -->
<g id="node4" class="node">
<title>vlswp</title>
<polygon fill="#00b2ee" stroke="transparent" points="607,-145 607,-161 692,-161 692,-145 607,-145"/>
<text text-anchor="start" x="609" y="-150.2" font-family="Microsoft YaHei" font-size="11.00">vls worker pool</text>
<polygon fill="none" stroke="black" points="607,-127 607,-145 692,-145 692,-127 607,-127"/>
<text text-anchor="start" x="646" y="-133.2" font-family="Microsoft YaHei" font-size="11.00">0</text>
<polygon fill="none" stroke="black" points="607,-109 607,-127 692,-127 692,-109 607,-109"/>
<text text-anchor="start" x="646" y="-115.2" font-family="Microsoft YaHei" font-size="11.00">1</text>
<polygon fill="none" stroke="black" points="607,-91 607,-109 692,-109 692,-91 607,-91"/>
<text text-anchor="start" x="646" y="-97.2" font-family="Microsoft YaHei" font-size="11.00">2</text>
<polygon fill="none" stroke="black" points="607,-73 607,-91 692,-91 692,-73 607,-73"/>
<text text-anchor="start" x="644.5" y="-79.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
<polygon fill="none" stroke="black" points="607,-55 607,-73 692,-73 692,-55 607,-55"/>
<text text-anchor="start" x="614.5" y="-61.2" font-family="Microsoft YaHei" font-size="11.00">max_workers</text>
</g>
<!-- vlsm&#45;&gt;vlswp -->
<g id="edge2" class="edge">
<title>vlsm:wk&#45;&gt;vlswp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216.5,-108C349.36,-108 505.23,-108 588.47,-108"/>
<polygon fill="black" stroke="black" points="588.49,-111.5 598.49,-108 588.49,-104.5 588.49,-111.5"/>
<text text-anchor="middle" x="381.5" y="-111.2" font-family="Microsoft YaHei" font-size="11.00">指向vls worker pool</text>
</g>
<!-- vlsw -->
<g id="node5" class="node">
<title>vlsw</title>
<polygon fill="#00b2ee" stroke="transparent" points="16.5,-242 16.5,-258 215.5,-258 215.5,-242 16.5,-242"/>
<text text-anchor="start" x="83" y="-247.2" font-family="Microsoft YaHei" font-size="11.00">vls_worker_t</text>
<polygon fill="none" stroke="black" points="16.5,-224 16.5,-242 215.5,-242 215.5,-224 16.5,-224"/>
<text text-anchor="start" x="25.5" y="-230.2" font-family="Microsoft YaHei" font-size="11.00">clib_rwlock_t sh_to_vlsh_table_lock</text>
<polygon fill="none" stroke="black" points="16.5,-206 16.5,-224 215.5,-224 215.5,-206 16.5,-206"/>
<text text-anchor="start" x="37.5" y="-212.2" font-family="Microsoft YaHei" font-size="11.00">vcl_locked_session_t *vls_pool</text>
<polygon fill="none" stroke="black" points="16.5,-188 16.5,-206 215.5,-206 215.5,-188 16.5,-188"/>
<text text-anchor="start" x="19.5" y="-194.2" font-family="Microsoft YaHei" font-size="11.00">uword *session_handle_to_vlsh_table</text>
<polygon fill="none" stroke="black" points="16.5,-170 16.5,-188 215.5,-188 215.5,-170 16.5,-170"/>
<text text-anchor="start" x="78" y="-176.2" font-family="Microsoft YaHei" font-size="11.00">u32 wrk_index</text>
</g>
<!-- vlsw&#45;&gt;vlswp -->
<g id="edge3" class="edge">
<title>vlsw:wi&#45;&gt;vlswp:0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216.5,-179C387.26,-179 430.18,-137.66 595.95,-136.05"/>
<polygon fill="black" stroke="black" points="606,-136 596.02,-140.55 601,-136.02 596,-136.05 596,-136.05 596,-136.05 601,-136.02 595.98,-131.55 606,-136 606,-136"/>
<text text-anchor="middle" x="381.5" y="-182.2" font-family="Microsoft YaHei" font-size="11.00">索引指向本结构的内存位置</text>
</g>
<!-- vcllsp -->
<g id="node6" class="node">
<title>vcllsp</title>
<polygon fill="#00b2ee" stroke="transparent" points="588,-277 588,-293 711,-293 711,-277 588,-277"/>
<text text-anchor="start" x="590" y="-282.2" font-family="Microsoft YaHei" font-size="11.00">vcl locked session pool</text>
<polygon fill="none" stroke="black" points="588,-259 588,-277 711,-277 711,-259 588,-259"/>
<text text-anchor="start" x="646" y="-265.2" font-family="Microsoft YaHei" font-size="11.00">0</text>
<polygon fill="none" stroke="black" points="588,-241 588,-259 711,-259 711,-241 588,-241"/>
<text text-anchor="start" x="646" y="-247.2" font-family="Microsoft YaHei" font-size="11.00">1</text>
<polygon fill="none" stroke="black" points="588,-223 588,-241 711,-241 711,-223 588,-223"/>
<text text-anchor="start" x="646" y="-229.2" font-family="Microsoft YaHei" font-size="11.00">2</text>
<polygon fill="none" stroke="black" points="588,-205 588,-223 711,-223 711,-205 588,-205"/>
<text text-anchor="start" x="644.5" y="-211.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
<polygon fill="none" stroke="black" points="588,-187 588,-205 711,-205 711,-187 588,-187"/>
<text text-anchor="start" x="646" y="-193.2" font-family="Microsoft YaHei" font-size="11.00">n</text>
</g>
<!-- vlsw&#45;&gt;vcllsp -->
<g id="edge4" class="edge">
<title>vlsw:vcllsp&#45;&gt;vcllsp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M216.5,-215C339.93,-215 482.89,-225.32 569.32,-232.7"/>
<polygon fill="black" stroke="black" points="569.05,-236.19 579.32,-233.56 569.65,-229.22 569.05,-236.19"/>
<text text-anchor="middle" x="381.5" y="-231.2" font-family="Microsoft YaHei" font-size="11.00">指向vcl locked session pool</text>
</g>
<!-- vlspl -->
<g id="node7" class="node">
<title>vlspl</title>
<polygon fill="#00b2ee" stroke="transparent" points="14.5,-648 14.5,-664 217.5,-664 217.5,-648 14.5,-648"/>
<text text-anchor="start" x="67.5" y="-653.2" font-family="Microsoft YaHei" font-size="11.00">vls_process_local_t</text>
<polygon fill="none" stroke="black" points="14.5,-630 14.5,-648 217.5,-648 217.5,-630 14.5,-630"/>
<text text-anchor="start" x="70" y="-636.2" font-family="Microsoft YaHei" font-size="11.00">int vls_wrk_index;</text>
<polygon fill="none" stroke="black" points="14.5,-612 14.5,-630 217.5,-630 217.5,-612 14.5,-612"/>
<text text-anchor="start" x="41" y="-618.2" font-family="Microsoft YaHei" font-size="11.00">volatile int vls_mt_n_threads;</text>
<polygon fill="none" stroke="black" points="14.5,-594 14.5,-612 217.5,-612 217.5,-594 14.5,-594"/>
<text text-anchor="start" x="23" y="-600.2" font-family="Microsoft YaHei" font-size="11.00">pthread_mutex_t vls_mt_mq_mlock;</text>
<polygon fill="none" stroke="black" points="14.5,-576 14.5,-594 217.5,-594 217.5,-576 14.5,-576"/>
<text text-anchor="start" x="17.5" y="-582.2" font-family="Microsoft YaHei" font-size="11.00">pthread_mutex_t vls_mt_spool_mlock;</text>
<polygon fill="none" stroke="black" points="14.5,-558 14.5,-576 217.5,-576 217.5,-558 14.5,-558"/>
<text text-anchor="start" x="42.5" y="-564.2" font-family="Microsoft YaHei" font-size="11.00">volatile u8 select_mp_check;</text>
<polygon fill="none" stroke="black" points="14.5,-540 14.5,-558 217.5,-558 217.5,-540 14.5,-540"/>
<text text-anchor="start" x="44.5" y="-546.2" font-family="Microsoft YaHei" font-size="11.00">volatile u8 epoll_mp_check;</text>
</g>
<!-- vclw -->
<g id="node8" class="node">
<title>vclw</title>
<polygon fill="#00b2ee" stroke="transparent" points="540,-787 540,-803 758,-803 758,-787 540,-787"/>
<text text-anchor="start" x="616" y="-792.2" font-family="Microsoft YaHei" font-size="11.00">vcl_worker_t</text>
<polygon fill="none" stroke="black" points="540,-757 540,-787 758,-787 758,-757 540,-757"/>
<text text-anchor="start" x="588" y="-775.2" font-family="Microsoft YaHei" font-size="11.00">vcl_session_t *sessions;</text>
<text text-anchor="start" x="624" y="-763.2" font-family="Microsoft YaHei" font-size="11.00">session池</text>
<polygon fill="none" stroke="black" points="540,-727 540,-757 758,-757 758,-727 540,-727"/>
<text text-anchor="start" x="609.5" y="-745.2" font-family="Microsoft YaHei" font-size="11.00">u32 wrk_index;</text>
<text text-anchor="start" x="591" y="-733.2" font-family="Microsoft YaHei" font-size="11.00">本进程中的worker索引</text>
<polygon fill="none" stroke="black" points="540,-697 540,-727 758,-727 758,-697 540,-697"/>
<text text-anchor="start" x="597" y="-715.2" font-family="Microsoft YaHei" font-size="11.00">u32 vpp_wrk_index;</text>
<text text-anchor="start" x="598" y="-703.2" font-family="Microsoft YaHei" font-size="11.00">vpp中的worker索引</text>
<polygon fill="none" stroke="black" points="540,-679 540,-697 758,-697 758,-679 540,-679"/>
<text text-anchor="start" x="591" y="-685.2" font-family="Microsoft YaHei" font-size="11.00">u32 api_client_handle;</text>
<polygon fill="none" stroke="black" points="540,-649 540,-679 758,-679 758,-649 540,-649"/>
<text text-anchor="start" x="569.5" y="-667.2" font-family="Microsoft YaHei" font-size="11.00">svm_queue_t *vl_input_queue;</text>
<text text-anchor="start" x="591.5" y="-655.2" font-family="Microsoft YaHei" font-size="11.00">vpp二进制api输入队列</text>
<polygon fill="none" stroke="black" points="540,-619 540,-649 758,-649 758,-619 540,-619"/>
<text text-anchor="start" x="588.5" y="-637.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t *ctrl_mq;</text>
<text text-anchor="start" x="546.5" y="-625.2" font-family="Microsoft YaHei" font-size="11.00">vpp的message queue 用来交换控制消息</text>
<polygon fill="none" stroke="black" points="540,-589 540,-619 758,-619 758,-589 540,-589"/>
<text text-anchor="start" x="613.5" y="-607.2" font-family="Microsoft YaHei" font-size="11.00">int mqs_epfd;</text>
<text text-anchor="start" x="601" y="-595.2" font-family="Microsoft YaHei" font-size="11.00">消息队列的epoll fd</text>
<polygon fill="none" stroke="black" points="540,-559 540,-589 758,-589 758,-559 540,-559"/>
<text text-anchor="start" x="557" y="-577.2" font-family="Microsoft YaHei" font-size="11.00">vcl_mq_evt_conn_t *mq_evt_conns;</text>
<text text-anchor="start" x="603.5" y="-565.2" font-family="Microsoft YaHei" font-size="11.00">消息队列的连接池</text>
<polygon fill="none" stroke="black" points="540,-529 540,-559 758,-559 758,-529 540,-529"/>
<text text-anchor="start" x="569" y="-547.2" font-family="Microsoft YaHei" font-size="11.00">struct epoll_event *mq_events;</text>
<text text-anchor="start" x="551" y="-535.2" font-family="Microsoft YaHei" font-size="11.00">worker缓冲区,用以接收mq的epoll事件</text>
<polygon fill="none" stroke="black" points="540,-499 540,-529 758,-529 758,-499 540,-499"/>
<text text-anchor="start" x="546.5" y="-517.2" font-family="Microsoft YaHei" font-size="11.00">uword *session_index_by_vpp_handles;</text>
<text text-anchor="start" x="580" y="-505.2" font-family="Microsoft YaHei" font-size="11.00">用来处理断开链接的hash表</text>
<polygon fill="none" stroke="black" points="540,-481 540,-499 758,-499 758,-481 540,-481"/>
<text text-anchor="start" x="644" y="-487.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
<polygon fill="none" stroke="black" points="540,-451 540,-481 758,-481 758,-451 540,-451"/>
<text text-anchor="start" x="562.5" y="-469.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t *app_event_queue;</text>
<text text-anchor="start" x="615" y="-457.2" font-family="Microsoft YaHei" font-size="11.00">事件消息队列</text>
<polygon fill="none" stroke="black" points="540,-433 540,-451 758,-451 758,-433 540,-433"/>
<text text-anchor="start" x="594.5" y="-439.2" font-family="Microsoft YaHei" font-size="11.00">clib_time_t clib_time;</text>
<polygon fill="none" stroke="black" points="540,-403 540,-433 758,-433 758,-403 540,-403"/>
<text text-anchor="start" x="552.5" y="-421.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_msg_t *mq_msg_vector;</text>
<text text-anchor="start" x="606.5" y="-409.2" font-family="Microsoft YaHei" font-size="11.00">mq消息的缓冲区</text>
<polygon fill="none" stroke="black" points="540,-373 540,-403 758,-403 758,-373 540,-373"/>
<text text-anchor="start" x="543" y="-391.2" font-family="Microsoft YaHei" font-size="11.00">session_event_t *unhandled_evts_vector;</text>
<text text-anchor="start" x="609.5" y="-379.2" font-family="Microsoft YaHei" font-size="11.00">存储未处理事件</text>
<polygon fill="none" stroke="black" points="540,-355 540,-373 758,-373 758,-355 540,-355"/>
<text text-anchor="start" x="554" y="-361.2" font-family="Microsoft YaHei" font-size="11.00">u32 *pending_session_wrk_updates;</text>
<polygon fill="none" stroke="black" points="540,-337 540,-355 758,-355 758,-337 540,-337"/>
<text text-anchor="start" x="578.5" y="-343.2" font-family="Microsoft YaHei" font-size="11.00">clib_socket_t app_api_sock;</text>
<polygon fill="none" stroke="black" points="540,-319 540,-337 758,-337 758,-319 540,-319"/>
<text text-anchor="start" x="644" y="-325.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
</g>
<!-- vlspl&#45;&gt;vclw -->
<g id="edge6" class="edge">
<title>vlspl:wi&#45;&gt;vclw</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M218.5,-639C321.83,-639 436.94,-616.87 521.95,-596.19"/>
<polygon fill="black" stroke="black" points="523.04,-599.53 531.91,-593.74 521.36,-592.73 523.04,-599.53"/>
<text text-anchor="middle" x="381.5" y="-642.2" font-family="Microsoft YaHei" font-size="11.00">通过索引获取对应的vcl_worker_t</text>
</g>
<!-- vclw&#45;&gt;vclwp -->
<g id="edge5" class="edge">
<title>vclw:wi&#45;&gt;vclwp:0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M759,-742C808.86,-742 760.24,-1146.17 784,-1190 843.46,-1299.7 887.26,-1355.88 1007.66,-1358.87"/>
<polygon fill="black" stroke="black" points="1018,-1359 1007.95,-1363.38 1013,-1358.94 1008,-1358.88 1008,-1358.88 1008,-1358.88 1013,-1358.94 1008.06,-1354.38 1018,-1359 1018,-1359"/>
<text text-anchor="middle" x="888" y="-1360.2" font-family="Microsoft YaHei" font-size="11.00">索引指向本结构的内存位置</text>
</g>
<!-- vclsp -->
<g id="node9" class="node">
<title>vclsp</title>
<polygon fill="#00b2ee" stroke="transparent" points="1018,-1000 1018,-1016 1104,-1016 1104,-1000 1018,-1000"/>
<text text-anchor="start" x="1020" y="-1005.2" font-family="Microsoft YaHei" font-size="11.00">vcl session pool</text>
<polygon fill="none" stroke="black" points="1018,-982 1018,-1000 1104,-1000 1104,-982 1018,-982"/>
<text text-anchor="start" x="1057.5" y="-988.2" font-family="Microsoft YaHei" font-size="11.00">0</text>
<polygon fill="none" stroke="black" points="1018,-964 1018,-982 1104,-982 1104,-964 1018,-964"/>
<text text-anchor="start" x="1057.5" y="-970.2" font-family="Microsoft YaHei" font-size="11.00">1</text>
<polygon fill="none" stroke="black" points="1018,-946 1018,-964 1104,-964 1104,-946 1018,-946"/>
<text text-anchor="start" x="1057.5" y="-952.2" font-family="Microsoft YaHei" font-size="11.00">2</text>
<polygon fill="none" stroke="black" points="1018,-928 1018,-946 1104,-946 1104,-928 1018,-928"/>
<text text-anchor="start" x="1056" y="-934.2" font-family="Microsoft YaHei" font-size="11.00">...</text>
<polygon fill="none" stroke="black" points="1018,-910 1018,-928 1104,-928 1104,-910 1018,-910"/>
<text text-anchor="start" x="1057.5" y="-916.2" font-family="Microsoft YaHei" font-size="11.00">n</text>
</g>
<!-- vclw&#45;&gt;vclsp -->
<g id="edge7" class="edge">
<title>vclw:vs&#45;&gt;vclsp</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M759,-772C855.69,-772 946.47,-843.14 1002.55,-898.59"/>
<polygon fill="black" stroke="black" points="1000.35,-901.34 1009.88,-905.95 1005.31,-896.4 1000.35,-901.34"/>
<text text-anchor="middle" x="888" y="-888.2" font-family="Microsoft YaHei" font-size="11.00">指向session池</text>
</g>
<!-- vcls -->
<g id="node10" class="node">
<title>vcls</title>
<polygon fill="#00b2ee" stroke="transparent" points="552,-1261 552,-1277 746,-1277 746,-1261 552,-1261"/>
<text text-anchor="start" x="615.5" y="-1266.2" font-family="Microsoft YaHei" font-size="11.00">vcl_session_t</text>
<polygon fill="none" stroke="black" points="552,-1243 552,-1261 746,-1261 746,-1243 552,-1243"/>
<text text-anchor="start" x="600" y="-1249.2" font-family="Microsoft YaHei" font-size="11.00">svm_fifo_t, *rx_fifo</text>
<polygon fill="none" stroke="black" points="552,-1225 552,-1243 746,-1243 746,-1225 552,-1225"/>
<text text-anchor="start" x="600" y="-1231.2" font-family="Microsoft YaHei" font-size="11.00">svm_fifo_t, *tx_fifo</text>
<polygon fill="none" stroke="black" points="552,-1207 552,-1225 746,-1225 746,-1207 552,-1207"/>
<text text-anchor="start" x="575" y="-1213.2" font-family="Microsoft YaHei" font-size="11.00">session_type_t, session_type</text>
<polygon fill="none" stroke="black" points="552,-1189 552,-1207 746,-1207 746,-1189 552,-1189"/>
<text text-anchor="start" x="584.5" y="-1195.2" font-family="Microsoft YaHei" font-size="11.00">volatile u8, session_state</text>
<polygon fill="none" stroke="black" points="552,-1171 552,-1189 746,-1189 746,-1171 552,-1171"/>
<text text-anchor="start" x="600" y="-1177.2" font-family="Microsoft YaHei" font-size="11.00">u32, session_index</text>
<polygon fill="none" stroke="black" points="552,-1153 552,-1171 746,-1171 746,-1153 552,-1153"/>
<text text-anchor="start" x="558.5" y="-1159.2" font-family="Microsoft YaHei" font-size="11.00">app_session_transport_t, transport</text>
<polygon fill="none" stroke="black" points="552,-1135 552,-1153 746,-1153 746,-1135 552,-1135"/>
<text text-anchor="start" x="581.5" y="-1141.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t, *vpp_evt_q</text>
<polygon fill="none" stroke="black" points="552,-1117 552,-1135 746,-1135 746,-1117 552,-1117"/>
<text text-anchor="start" x="585" y="-1123.2" font-family="Microsoft YaHei" font-size="11.00">vcl_session_flags_t flags;</text>
<polygon fill="none" stroke="black" points="552,-1099 552,-1117 746,-1117 746,-1099 552,-1099"/>
<text text-anchor="start" x="590" y="-1105.2" font-family="Microsoft YaHei" font-size="11.00">u32 rx_bytes_pending;</text>
<polygon fill="none" stroke="black" points="552,-1081 552,-1099 746,-1099 746,-1081 552,-1081"/>
<text text-anchor="start" x="593" y="-1087.2" font-family="Microsoft YaHei" font-size="11.00">svm_fifo_t *ct_rx_fifo;</text>
<polygon fill="none" stroke="black" points="552,-1063 552,-1081 746,-1081 746,-1063 552,-1063"/>
<text text-anchor="start" x="593" y="-1069.2" font-family="Microsoft YaHei" font-size="11.00">svm_fifo_t *ct_tx_fifo;</text>
<polygon fill="none" stroke="black" points="552,-1045 552,-1063 746,-1063 746,-1045 552,-1045"/>
<text text-anchor="start" x="555" y="-1051.2" font-family="Microsoft YaHei" font-size="11.00">vcl_session_msg_t *accept_evts_fifo;</text>
<polygon fill="none" stroke="black" points="552,-1027 552,-1045 746,-1045 746,-1027 552,-1027"/>
<text text-anchor="start" x="605.5" y="-1033.2" font-family="Microsoft YaHei" font-size="11.00">u64 vpp_handle;</text>
<polygon fill="none" stroke="black" points="552,-1009 552,-1027 746,-1027 746,-1009 552,-1009"/>
<text text-anchor="start" x="599" y="-1015.2" font-family="Microsoft YaHei" font-size="11.00">u64 parent_handle;</text>
<polygon fill="none" stroke="black" points="552,-991 552,-1009 746,-1009 746,-991 552,-991"/>
<text text-anchor="start" x="600" y="-997.2" font-family="Microsoft YaHei" font-size="11.00">u32 listener_index;</text>
<polygon fill="none" stroke="black" points="552,-973 552,-991 746,-991 746,-973 552,-973"/>
<text text-anchor="start" x="585.5" y="-979.2" font-family="Microsoft YaHei" font-size="11.00">int n_accepted_sessions;</text>
<polygon fill="none" stroke="black" points="552,-955 552,-973 746,-973 746,-955 552,-955"/>
<text text-anchor="start" x="595.5" y="-961.2" font-family="Microsoft YaHei" font-size="11.00">vppcom_epoll_t vep;</text>
<polygon fill="none" stroke="black" points="552,-937 552,-955 746,-955 746,-937 552,-937"/>
<text text-anchor="start" x="611" y="-943.2" font-family="Microsoft YaHei" font-size="11.00">u32 attributes;</text>
<polygon fill="none" stroke="black" points="552,-919 552,-937 746,-937 746,-919 552,-919"/>
<text text-anchor="start" x="615.5" y="-925.2" font-family="Microsoft YaHei" font-size="11.00">int libc_epfd;</text>
<polygon fill="none" stroke="black" points="552,-901 552,-919 746,-919 746,-901 552,-901"/>
<text text-anchor="start" x="603.5" y="-907.2" font-family="Microsoft YaHei" font-size="11.00">u32 ckpair_index;</text>
<polygon fill="none" stroke="black" points="552,-883 552,-901 746,-901 746,-883 552,-883"/>
<text text-anchor="start" x="628" y="-889.2" font-family="Microsoft YaHei" font-size="11.00">u32 vrf;</text>
<polygon fill="none" stroke="black" points="552,-865 552,-883 746,-883 746,-865 552,-865"/>
<text text-anchor="start" x="605" y="-871.2" font-family="Microsoft YaHei" font-size="11.00">u32 sndbuf_size;</text>
<polygon fill="none" stroke="black" points="552,-847 552,-865 746,-865 746,-847 552,-847"/>
<text text-anchor="start" x="607" y="-853.2" font-family="Microsoft YaHei" font-size="11.00">u32 rcvbuf_size;</text>
<polygon fill="none" stroke="black" points="552,-829 552,-847 746,-847 746,-829 552,-829"/>
<text text-anchor="start" x="611" y="-835.2" font-family="Microsoft YaHei" font-size="11.00">u32 user_mss;</text>
</g>
<!-- vcls&#45;&gt;vclsp -->
<g id="edge8" class="edge">
<title>vcls:si&#45;&gt;vclsp:0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M747,-1180C890.05,-1180 871.5,-999.76 1006.98,-991.31"/>
<polygon fill="black" stroke="black" points="1017,-991 1007.14,-995.8 1012,-991.15 1007,-991.31 1007,-991.31 1007,-991.31 1012,-991.15 1006.87,-986.81 1017,-991 1017,-991"/>
<text text-anchor="middle" x="888" y="-1177.2" font-family="Microsoft YaHei" font-size="11.00">索引指向本结构在session池中的内存位置</text>
</g>
<!-- vclls -->
<g id="node11" class="node">
<title>vclls</title>
<polygon fill="#00b2ee" stroke="transparent" points="8.5,-498 8.5,-514 223.5,-514 223.5,-498 8.5,-498"/>
<text text-anchor="start" x="63" y="-503.2" font-family="Microsoft YaHei" font-size="11.00">vcl_locked_session_t</text>
<polygon fill="none" stroke="black" points="8.5,-480 8.5,-498 223.5,-498 223.5,-480 8.5,-480"/>
<text text-anchor="start" x="64.5" y="-486.2" font-family="Microsoft YaHei" font-size="11.00">clib_spinlock_t lock;</text>
<polygon fill="none" stroke="black" points="8.5,-462 8.5,-480 223.5,-480 223.5,-462 8.5,-462"/>
<text text-anchor="start" x="67" y="-468.2" font-family="Microsoft YaHei" font-size="11.00">u32 session_index;</text>
<polygon fill="none" stroke="black" points="8.5,-444 8.5,-462 223.5,-462 223.5,-444 8.5,-444"/>
<text text-anchor="start" x="67.5" y="-450.2" font-family="Microsoft YaHei" font-size="11.00">u32 worker_index;</text>
<polygon fill="none" stroke="black" points="8.5,-426 8.5,-444 223.5,-444 223.5,-426 8.5,-426"/>
<text text-anchor="start" x="79" y="-432.2" font-family="Microsoft YaHei" font-size="11.00">u32 vls_index;</text>
<polygon fill="none" stroke="black" points="8.5,-408 8.5,-426 223.5,-426 223.5,-408 8.5,-408"/>
<text text-anchor="start" x="55" y="-414.2" font-family="Microsoft YaHei" font-size="11.00">u32 shared_data_index;</text>
<polygon fill="none" stroke="black" points="8.5,-390 8.5,-408 223.5,-408 223.5,-390 8.5,-390"/>
<text text-anchor="start" x="47.5" y="-396.2" font-family="Microsoft YaHei" font-size="11.00">u32 owner_vcl_wrk_index;</text>
<polygon fill="none" stroke="black" points="8.5,-372 8.5,-390 223.5,-390 223.5,-372 8.5,-372"/>
<text text-anchor="start" x="11.5" y="-378.2" font-family="Microsoft YaHei" font-size="11.00">uword *vcl_wrk_index_to_session_index;</text>
</g>
<!-- vclls&#45;&gt;vcllsp -->
<g id="edge11" class="edge">
<title>vclls:vi&#45;&gt;vcllsp:0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.5,-435C398.42,-435 409.25,-274.46 576.8,-268.19"/>
<polygon fill="black" stroke="black" points="587,-268 577.08,-272.68 582,-268.09 577,-268.18 577,-268.18 577,-268.18 582,-268.09 576.92,-263.69 587,-268 587,-268"/>
<text text-anchor="middle" x="381.5" y="-437.2" font-family="Microsoft YaHei" font-size="11.00">索引指向本结构vcl locked session pool中内存的位置</text>
</g>
<!-- vclls&#45;&gt;vclw -->
<g id="edge10" class="edge">
<title>vclls:wi&#45;&gt;vclw</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.5,-453C326.97,-453 439.18,-483.05 522.34,-511.45"/>
<polygon fill="black" stroke="black" points="521.23,-514.77 531.82,-514.73 523.51,-508.16 521.23,-514.77"/>
<text text-anchor="middle" x="381.5" y="-510.2" font-family="Microsoft YaHei" font-size="11.00">通过索引获取vcl_worker_t</text>
</g>
<!-- vclls&#45;&gt;vcls -->
<g id="edge9" class="edge">
<title>vclls:si&#45;&gt;vcls</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M224.5,-471C250.05,-471 229.11,-506.97 249,-523 343.1,-598.84 435.13,-492.42 514,-584 547.75,-623.18 518.39,-766.11 532,-816 534.51,-825.18 537.37,-834.44 540.51,-843.69"/>
<polygon fill="black" stroke="black" points="537.28,-845.05 543.89,-853.33 543.89,-842.74 537.28,-845.05"/>
<text text-anchor="middle" x="381.5" y="-587.2" font-family="Microsoft YaHei" font-size="11.00">通过索引可以获取对应的vcl_session_t</text>
</g>
</g>
</svg>

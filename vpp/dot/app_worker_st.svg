<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: app Pages: 1 -->
<svg width="1035pt" height="583pt"
 viewBox="0.00 0.00 1035.00 583.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 579)">
<title>app</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-579 1031,-579 1031,4 -4,4"/>
<text text-anchor="middle" x="513.5" y="-7.8" font-family="Times,serif" font-size="14.00">app_worker_t 相关结构及部分关系</text>
<!-- awst -->
<g id="node1" class="node">
<title>awst</title>
<text text-anchor="start" x="66.5" y="-448.2" font-family="Microsoft YaHei" font-size="11.00">app_worker_t</text>
<polygon fill="none" stroke="black" points="8.5,-413 8.5,-443 195.5,-443 195.5,-413 8.5,-413"/>
<text text-anchor="start" x="44" y="-431.2" font-family="Microsoft YaHei" font-size="11.00">在全局worker中的索引</text>
<text text-anchor="start" x="62.5" y="-419.2" font-family="Microsoft YaHei" font-size="11.00">u32 wrk_index;</text>
<polygon fill="none" stroke="black" points="8.5,-383 8.5,-413 195.5,-413 195.5,-383 8.5,-383"/>
<text text-anchor="start" x="34" y="-401.2" font-family="Microsoft YaHei" font-size="11.00">映射到app中的worker索引</text>
<text text-anchor="start" x="48" y="-389.2" font-family="Microsoft YaHei" font-size="11.00">u32 wrk_map_index;</text>
<polygon fill="none" stroke="black" points="8.5,-353 8.5,-383 195.5,-383 195.5,-353 8.5,-353"/>
<text text-anchor="start" x="80.5" y="-371.2" font-family="Microsoft YaHei" font-size="11.00">app索引</text>
<text text-anchor="start" x="62.5" y="-359.2" font-family="Microsoft YaHei" font-size="11.00">u32 app_index;</text>
<polygon fill="none" stroke="black" points="8.5,-323 8.5,-353 195.5,-353 195.5,-323 8.5,-323"/>
<text text-anchor="start" x="40" y="-341.2" font-family="Microsoft YaHei" font-size="11.00">应用在此队列上监听事件</text>
<text text-anchor="start" x="28" y="-329.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t *event_queue;</text>
<polygon fill="none" stroke="black" points="8.5,-305 8.5,-323 195.5,-323 195.5,-305 8.5,-305"/>
<text text-anchor="start" x="28" y="-311.2" font-family="Microsoft YaHei" font-size="11.00">u32 connects_seg_manager;</text>
<polygon fill="none" stroke="black" points="8.5,-287 8.5,-305 195.5,-305 195.5,-287 8.5,-287"/>
<text text-anchor="start" x="42.5" y="-293.2" font-family="Microsoft YaHei" font-size="11.00">uword *listeners_table;</text>
<polygon fill="none" stroke="black" points="8.5,-269 8.5,-287 195.5,-287 195.5,-269 8.5,-269"/>
<text text-anchor="start" x="27.5" y="-275.2" font-family="Microsoft YaHei" font-size="11.00">u32 first_segment_manager;</text>
<polygon fill="none" stroke="black" points="8.5,-251 8.5,-269 195.5,-269 195.5,-251 8.5,-251"/>
<text text-anchor="start" x="11.5" y="-257.2" font-family="Microsoft YaHei" font-size="11.00">u8 first_segment_manager_in_use;</text>
<polygon fill="none" stroke="black" points="8.5,-233 8.5,-251 195.5,-251 195.5,-233 8.5,-233"/>
<text text-anchor="start" x="47.5" y="-239.2" font-family="Microsoft YaHei" font-size="11.00">u32 api_client_index;</text>
<polygon fill="none" stroke="black" points="8.5,-215 8.5,-233 195.5,-233 195.5,-215 8.5,-215"/>
<text text-anchor="start" x="56.5" y="-221.2" font-family="Microsoft YaHei" font-size="11.00">u8 app_is_builtin;</text>
<polygon fill="none" stroke="black" points="8.5,-197 8.5,-215 195.5,-215 195.5,-197 8.5,-197"/>
<text text-anchor="start" x="36" y="-203.2" font-family="Microsoft YaHei" font-size="11.00">uword **half_open_table;</text>
<polygon fill="none" stroke="black" points="8.5,-167 8.5,-197 195.5,-197 195.5,-167 8.5,-167"/>
<text text-anchor="start" x="62.5" y="-185.2" font-family="Microsoft YaHei" font-size="11.00">clib_spinlock_t </text>
<text text-anchor="start" x="22" y="-173.2" font-family="Microsoft YaHei" font-size="11.00"> detached_seg_managers_lock;</text>
<polygon fill="none" stroke="black" points="8.5,-149 8.5,-167 195.5,-167 195.5,-149 8.5,-149"/>
<text text-anchor="start" x="22.5" y="-155.2" font-family="Microsoft YaHei" font-size="11.00">u32 *detached_seg_managers;</text>
</g>
<!-- smq -->
<g id="node2" class="node">
<title>smq</title>
<text text-anchor="start" x="283.5" y="-365.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_t</text>
<polygon fill="none" stroke="black" points="248.5,-330 248.5,-360 389.5,-360 389.5,-330 248.5,-330"/>
<text text-anchor="start" x="263" y="-348.2" font-family="Microsoft YaHei" font-size="11.00">用于交换消息的queue</text>
<text text-anchor="start" x="258.5" y="-336.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_queue_t q;</text>
<polygon fill="none" stroke="black" points="248.5,-300 248.5,-330 389.5,-330 389.5,-300 248.5,-300"/>
<text text-anchor="start" x="269" y="-318.2" font-family="Microsoft YaHei" font-size="11.00">存放消息数据的ring</text>
<text text-anchor="start" x="251.5" y="-306.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_ring_t *rings;</text>
</g>
<!-- awst&#45;&gt;smq -->
<g id="edge5" class="edge">
<title>awst:eq&#45;&gt;smq</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M196.5,-338C207.2,-338 218.42,-338 229.55,-338"/>
<polygon fill="black" stroke="black" points="229.72,-341.5 239.72,-338 229.72,-334.5 229.72,-341.5"/>
</g>
<!-- smqq -->
<g id="node3" class="node">
<title>smqq</title>
<text text-anchor="start" x="478.5" y="-416.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_queue_t</text>
<polygon fill="none" stroke="black" points="442,-381 442,-411 624,-411 624,-381 442,-381"/>
<text text-anchor="start" x="499" y="-399.2" font-family="Microsoft YaHei" font-size="11.00">指向共享队列</text>
<text text-anchor="start" x="445" y="-387.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_shared_queue_t *shr;</text>
<polygon fill="none" stroke="black" points="442,-351 442,-381 624,-381 624,-351 442,-351"/>
<text text-anchor="start" x="471.5" y="-369.2" font-family="Microsoft YaHei" font-size="11.00">生产者/消费者的eventfd</text>
<text text-anchor="start" x="510" y="-357.2" font-family="Microsoft YaHei" font-size="11.00">int evtfd;</text>
<polygon fill="none" stroke="black" points="442,-321 442,-351 624,-351 624,-321 442,-321"/>
<text text-anchor="start" x="482" y="-339.2" font-family="Microsoft YaHei" font-size="11.00">多生产者时的互斥锁</text>
<text text-anchor="start" x="481.5" y="-327.2" font-family="Microsoft YaHei" font-size="11.00">clib_spinlock_t lock;</text>
</g>
<!-- smq&#45;&gt;smqq -->
<g id="edge6" class="edge">
<title>smq:smqq&#45;&gt;smqq</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390.5,-345C401.35,-345 412.57,-345.83 423.73,-347.2"/>
<polygon fill="black" stroke="black" points="423.56,-350.71 433.95,-348.61 424.52,-343.78 423.56,-350.71"/>
</g>
<!-- smqr -->
<g id="node4" class="node">
<title>smqr</title>
<text text-anchor="start" x="485" y="-278.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_ring_t</text>
<polygon fill="none" stroke="black" points="448,-243 448,-273 619,-273 619,-243 448,-243"/>
<text text-anchor="start" x="477.5" y="-261.2" font-family="Microsoft YaHei" font-size="11.00">ring中的元素最大个数</text>
<text text-anchor="start" x="502.5" y="-249.2" font-family="Microsoft YaHei" font-size="11.00">u32 nitems;</text>
<polygon fill="none" stroke="black" points="448,-213 448,-243 619,-243 619,-213 448,-213"/>
<text text-anchor="start" x="489" y="-231.2" font-family="Microsoft YaHei" font-size="11.00">ring中的元素大小</text>
<text text-anchor="start" x="506" y="-219.2" font-family="Microsoft YaHei" font-size="11.00">u32 elsize;</text>
<polygon fill="none" stroke="black" points="448,-183 448,-213 619,-213 619,-183 448,-183"/>
<text text-anchor="start" x="483.5" y="-201.2" font-family="Microsoft YaHei" font-size="11.00">位于共享内存的ring</text>
<text text-anchor="start" x="451" y="-189.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_ring_shared_t *shr;</text>
</g>
<!-- smq&#45;&gt;smqr -->
<g id="edge7" class="edge">
<title>smq:smqr&#45;&gt;smqr</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390.5,-315C412,-315 433.26,-307.96 452.53,-298.09"/>
<polygon fill="black" stroke="black" points="454.4,-301.05 461.52,-293.2 451.06,-294.9 454.4,-301.05"/>
</g>
<!-- smqsq -->
<g id="node5" class="node">
<title>smqsq</title>
<text text-anchor="start" x="679" y="-560.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_shared_queue_t</text>
<polygon fill="none" stroke="black" points="677,-537 677,-555 829,-555 829,-537 677,-537"/>
<text text-anchor="start" x="690.5" y="-543.2" font-family="Microsoft YaHei" font-size="11.00">pthread_mutex_t mutex;</text>
<polygon fill="none" stroke="black" points="677,-507 677,-537 829,-537 829,-507 677,-507"/>
<text text-anchor="start" x="730" y="-525.2" font-family="Microsoft YaHei" font-size="11.00">条件变量</text>
<text text-anchor="start" x="689" y="-513.2" font-family="Microsoft YaHei" font-size="11.00">pthread_cond_t condvar;</text>
<polygon fill="none" stroke="black" points="677,-489 677,-507 829,-507 829,-489 677,-489"/>
<text text-anchor="start" x="727" y="-495.2" font-family="Microsoft YaHei" font-size="11.00">u32 head;</text>
<polygon fill="none" stroke="black" points="677,-471 677,-489 829,-489 829,-471 677,-471"/>
<text text-anchor="start" x="731.5" y="-477.2" font-family="Microsoft YaHei" font-size="11.00">u32 tail;</text>
<polygon fill="none" stroke="black" points="677,-453 677,-471 829,-471 829,-453 677,-453"/>
<text text-anchor="start" x="701.5" y="-459.2" font-family="Microsoft YaHei" font-size="11.00">volatile u32 cursize;</text>
<polygon fill="none" stroke="black" points="677,-435 677,-453 829,-453 829,-435 677,-435"/>
<text text-anchor="start" x="719" y="-441.2" font-family="Microsoft YaHei" font-size="11.00">u32 maxsize;</text>
<polygon fill="none" stroke="black" points="677,-417 677,-435 829,-435 829,-417 677,-417"/>
<text text-anchor="start" x="725.5" y="-423.2" font-family="Microsoft YaHei" font-size="11.00">u32 elsize;</text>
<polygon fill="none" stroke="black" points="677,-399 677,-417 829,-417 829,-399 677,-399"/>
<text text-anchor="start" x="730" y="-405.2" font-family="Microsoft YaHei" font-size="11.00">u32 pad;</text>
<polygon fill="orange" stroke="transparent" points="677,-369 677,-399 829,-399 829,-369 677,-369"/>
<polygon fill="none" stroke="black" points="677,-369 677,-399 829,-399 829,-369 677,-369"/>
<text text-anchor="start" x="702" y="-387.2" font-family="Microsoft YaHei" font-size="11.00">data内存的起始位置</text>
<text text-anchor="start" x="727" y="-375.2" font-family="Microsoft YaHei" font-size="11.00">第0个元素</text>
<polygon fill="orange" stroke="transparent" points="677,-351 677,-369 829,-369 829,-351 677,-351"/>
<polygon fill="none" stroke="black" points="677,-351 677,-369 829,-369 829,-351 677,-351"/>
<text text-anchor="start" x="725.5" y="-357.2" font-family="Microsoft YaHei" font-size="11.00">第1个元素 </text>
<polygon fill="orange" stroke="transparent" points="677,-333 677,-351 829,-351 829,-333 677,-333"/>
<polygon fill="none" stroke="black" points="677,-333 677,-351 829,-351 829,-333 677,-333"/>
<text text-anchor="start" x="746.5" y="-339.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="677,-315 677,-333 829,-333 829,-315 677,-315"/>
<polygon fill="none" stroke="black" points="677,-315 677,-333 829,-333 829,-315 677,-315"/>
<text text-anchor="start" x="746.5" y="-321.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="677,-297 677,-315 829,-315 829,-297 677,-297"/>
<polygon fill="none" stroke="black" points="677,-297 677,-315 829,-315 829,-297 677,-297"/>
<text text-anchor="start" x="746.5" y="-303.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="677,-279 677,-297 829,-297 829,-279 677,-279"/>
<polygon fill="none" stroke="black" points="677,-279 677,-297 829,-297 829,-279 677,-279"/>
<text text-anchor="start" x="704" y="-285.2" font-family="Microsoft YaHei" font-size="11.00">第maxsize&#45;1个元素</text>
</g>
<!-- smqq&#45;&gt;smqsq -->
<g id="edge8" class="edge">
<title>smqq:smqsq&#45;&gt;smqsq</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M625,-396C636.11,-396 647.63,-397.07 658.99,-398.79"/>
<polygon fill="black" stroke="black" points="658.48,-402.26 668.93,-400.47 659.65,-395.35 658.48,-402.26"/>
</g>
<!-- smqrs -->
<g id="node6" class="node">
<title>smqrs</title>
<text text-anchor="start" x="685" y="-242.2" font-family="Microsoft YaHei" font-size="11.00">svm_msg_q_ring_shared_t</text>
<polygon fill="none" stroke="black" points="683,-219 683,-237 824,-237 824,-219 683,-219"/>
<text text-anchor="start" x="702" y="-225.2" font-family="Microsoft YaHei" font-size="11.00">volatile u32 cursize;</text>
<polygon fill="none" stroke="black" points="683,-201 683,-219 824,-219 824,-201 683,-201"/>
<text text-anchor="start" x="722.5" y="-207.2" font-family="Microsoft YaHei" font-size="11.00">u32 nitems;</text>
<polygon fill="none" stroke="black" points="683,-183 683,-201 824,-201 824,-183 683,-183"/>
<text text-anchor="start" x="707" y="-189.2" font-family="Microsoft YaHei" font-size="11.00">volatile u32 head;</text>
<polygon fill="none" stroke="black" points="683,-165 683,-183 824,-183 824,-165 683,-165"/>
<text text-anchor="start" x="712" y="-171.2" font-family="Microsoft YaHei" font-size="11.00">volatile u32 tail;</text>
<polygon fill="none" stroke="black" points="683,-147 683,-165 824,-165 824,-147 683,-147"/>
<text text-anchor="start" x="726" y="-153.2" font-family="Microsoft YaHei" font-size="11.00">u32 elsize;</text>
<polygon fill="orange" stroke="transparent" points="683,-117 683,-147 824,-147 824,-117 683,-117"/>
<polygon fill="none" stroke="black" points="683,-117 683,-147 824,-147 824,-117 683,-117"/>
<text text-anchor="start" x="702.5" y="-135.2" font-family="Microsoft YaHei" font-size="11.00">data内存的起始位置</text>
<text text-anchor="start" x="727.5" y="-123.2" font-family="Microsoft YaHei" font-size="11.00">第0个元素</text>
<polygon fill="orange" stroke="transparent" points="683,-99 683,-117 824,-117 824,-99 683,-99"/>
<polygon fill="none" stroke="black" points="683,-99 683,-117 824,-117 824,-99 683,-99"/>
<text text-anchor="start" x="723.5" y="-105.2" font-family="Microsoft YaHei" font-size="11.00">第一个元素 </text>
<polygon fill="orange" stroke="transparent" points="683,-81 683,-99 824,-99 824,-81 683,-81"/>
<polygon fill="none" stroke="black" points="683,-81 683,-99 824,-99 824,-81 683,-81"/>
<text text-anchor="start" x="747" y="-87.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="683,-63 683,-81 824,-81 824,-63 683,-63"/>
<polygon fill="none" stroke="black" points="683,-63 683,-81 824,-81 824,-63 683,-63"/>
<text text-anchor="start" x="747" y="-69.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="683,-45 683,-63 824,-63 824,-45 683,-45"/>
<polygon fill="none" stroke="black" points="683,-45 683,-63 824,-63 824,-45 683,-45"/>
<text text-anchor="start" x="747" y="-51.2" font-family="Microsoft YaHei" font-size="11.00">... </text>
<polygon fill="orange" stroke="transparent" points="683,-27 683,-45 824,-45 824,-27 683,-27"/>
<polygon fill="none" stroke="black" points="683,-27 683,-45 824,-45 824,-27 683,-27"/>
<text text-anchor="start" x="707.5" y="-33.2" font-family="Microsoft YaHei" font-size="11.00">第nitems&#45;1个元素</text>
</g>
<!-- smqr&#45;&gt;smqrs -->
<g id="edge9" class="edge">
<title>smqr:smqrs&#45;&gt;smqrs</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M620,-198C635.09,-198 650.4,-194.78 664.98,-189.86"/>
<polygon fill="black" stroke="black" points="666.26,-193.12 674.45,-186.4 663.85,-186.55 666.26,-193.12"/>
</g>
<!-- smqsq&#45;&gt;smqsq -->
<g id="edge1" class="edge">
<title>smqsq:e&#45;&gt;smqsq:e</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M829,-498C854,-507 888,-507 888,-441 888,-383.25 861.97,-376.03 838.71,-381.16"/>
<polygon fill="black" stroke="black" points="837.61,-377.83 829,-384 839.58,-384.55 837.61,-377.83"/>
<text text-anchor="middle" x="957.5" y="-422.2" font-family="Microsoft YaHei" font-size="11.00">head的值代表内存中的索引</text>
</g>
<!-- smqsq&#45;&gt;smqsq -->
<g id="edge2" class="edge">
<title>smqsq:e&#45;&gt;smqsq:e</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M829,-480C854,-489 888,-489 888,-432 888,-382.12 861.97,-375.89 838.71,-381.14"/>
<polygon fill="black" stroke="black" points="837.6,-377.82 829,-384 839.58,-384.53 837.6,-377.82"/>
</g>
<!-- smqrs&#45;&gt;smqrs -->
<g id="edge3" class="edge">
<title>smqrs:e&#45;&gt;smqrs:e</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M824,-192C848.5,-201 882.5,-201 882.5,-162 882.5,-128.03 856.7,-123.65 833.86,-129.03"/>
<polygon fill="black" stroke="black" points="832.57,-125.77 824,-132 834.58,-132.47 832.57,-125.77"/>
</g>
<!-- smqrs&#45;&gt;smqrs -->
<g id="edge4" class="edge">
<title>smqrs:e&#45;&gt;smqrs:e</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M824,-174C848.5,-183 882.5,-183 882.5,-153 882.5,-126.87 856.7,-123.5 833.86,-129.01"/>
<polygon fill="black" stroke="black" points="832.55,-125.75 824,-132 834.59,-132.45 832.55,-125.75"/>
<text text-anchor="middle" x="947" y="-137.2" font-family="Microsoft YaHei" font-size="11.00">tail的值代表内存中的索引</text>
</g>
</g>
</svg>
